<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no">
	<title>Filter Plots</title>
	<script src="https://zimjs.org/cdn/zim.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const url = 'https://clock.imamkatz.com/folgers';
			async function fetchData() {
				try {
					const response = await fetch(url);
					const data = await response.json();
					submitData(data);
				} catch (error) {
					console.error('Error fetching data:', error);
				}
			}

			function submitData(data) {
				let totalPlota = data.filterPlots;
				let assetsunlocked = [];
				let openSeaLink = [];
				totalPlota.forEach((plot, i) => {
					assetsunlocked.push(`https://meta.tmwstw.io/preview_plots_${plot}.jpg`);
					openSeaLink.push(`https://opensea.io/assets/ethereum/0xeed10864e9fd813d12a0f40eb5f73ff2d31b2abb/${plot}`);
				});

				const stage = new zim.Stage("fit", 1024, 768);
				const frame = new zim.Frame("fit", 1024, 768, "#FFFFFF", stage);
				frame.on("ready", () => {
					const container = new zim.Container();
					stage.addChild(container);

					function drawPlots() {
						container.removeAllChildren();
						let squ = 10;
						let row = 10;
						let loopy = 0;
						assetsunlocked.forEach((asset, i) => {
							const pic = new zim.Bitmap(asset).center(container).loc(squ, row).sca(0.18).tap(() => {
								window.open(openSeaLink[i], '_blank');
							});
							squ += 95;
							loopy += 1;
							if (loopy === 16) {
								loopy = 0;
								squ = 10; // back to square 1
								row += 95;
							}
						});
					}

					drawPlots();

					window.addEventListener('resize', () => {
						stage.update();
						drawPlots();
					});

					stage.update();
				});
			}

			fetchData();
		});
	</script>
</head>

<body>
</body>

</html>